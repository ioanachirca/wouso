{% extends 'cpanel/index.html' %}
{% load i18n %}
{% load user %}
{% load django_bootstrap_breadcrumbs %}
{% block sectiontitle %}
    Proposed Question

    {% block breadcrumbs %}

        {{ block.super }}

        {% breadcrumb "Proposed Questions" "proposed_home" %}

    {% endblock %}

{% endblock %}

{% block sectioncontent %}

    <div class="container">

        <ul class="nav nav-tabs">
            {% for category in categories %}
                <li><a href="#{{ category.name }}">{{ category.name }}</a></li>
            {% endfor %}
        </ul>


        <div class="tab-content">
            {% for category in categories %}
                <div id="{{ category.name }}" class="tab-pane fade in active">

                    {% for question in category.proposed_questions.all %}
                        {% with status="P" %}
                            {% if question.status = status %}
                                <table  class="table table-bordered table-striped pq-review">
                                    <tr><td>Question:<br>{{ question.text }}</td></tr>
                                    {% for answer in question.answers %}
                                         <tr><td {% if answer.correct %} class="correct-answer" {% endif %}>Answer:<br>{{ answer.text }}</td></tr>
                                    {% endfor %}
                                    <tr> <td><button type="button" class="btn btn-info" data-toggle="collapse" data-target="#td_{{ question.id }}">Details</button></td></tr>
                                    <tr>
                                        <td id="td_{{ question.id }}" class="collapse">
                                            <div id="div_{{ question.id }}">
                                                <form id="{{ question.id }}" action="" method="POST">
                                                    {% csrf_token %}
                                                    {{form.as_p}}
                                                    <button class="sub-button" id="acceptBtn">Accept</button>
                                                    <button class="sub-button" id="declineBtn">Decline</button>
                                                </form>
                                           </div>
                                        </td>
                                    </tr>
                                </table>
                            {% endif %}
                        {% endwith %}
                    {% endfor %}
                    
                </div>
            {% endfor %}
        </div>
    







    <script type="text/javascript">
       
        $("button").click(function(event){
                event.preventDefault();
                var button_id = $(this).attr('id');
                var question_id = $(this).parent().attr('id');
                var div_id = $(this).parent().parent().attr('id');
  
            $.ajax({
                    type:"POST",
                    data: { 
                        button_id : button_id,
                        question_id : question_id,
                        data: $(this).parent('form').serialize(),
                    }

                , success: function(result){
                $("#"+div_id).html(result);
            }});
        });            

    </script>













  <script>
        $(document).ready(function(){
            $(".nav-tabs a").click(function(){
                $(this).tab('show');
            });
        });
    </script>
{% endblock %}
